太棒了！把项目原理记录下来是一个非常好的习惯，不仅方便自己日后维护，也能帮助其他人理解你的代码。

这是一份为你准备的 **GitHub `README.md` 模板**。我将技术原理拆解成了清晰的模块，重点解释了为什么要用外部工具替代系统默认设置（这也是这个脚本最有价值的地方）。

你可以直接复制下面的 Markdown 内容：

-----

# 🖨️ Windows 批量静默打印小助手 (Python GUI)

这是一个基于 Python `tkinter` 开发的桌面小工具，用于在 Windows 环境下批量打印 **PDF** 和 **图片** 文件。

## 💡 项目背景与解决的问题

在 Windows 开发中，直接使用 Python 标准库 `os.startfile(file, "print")` 调用系统打印功能时，经常遇到以下痛点：

1.  **PDF 打印报错 (Error 31)**：
      * **原因**：现代浏览器（Edge/Chrome）通常接管了 PDF 的默认打开方式，但它们并不支持通过 Shell 命令直接调用“打印”接口，导致 `ShellExecute` 抛出“设备没有发挥作用”的错误。
2.  **图片打印弹出交互框**：
      * **原因**：Windows 默认的“照片”应用在被调用打印时，会弹出一个预览窗口要求用户点击确认，导致无法实现全自动批量打印。
3.  **界面假死**：
      * **原因**：单线程程序在执行打印 I/O 操作时会阻塞主循环，导致软件窗口无响应。

## 🛠️ 技术原理与实现方案

本项目通过\*\*“指定外部工具 + 命令行参数”\*\*的方式绕过了系统默认关联，实现了稳定、静默的打印。

### 1\. PDF 打印原理：调用 SumatraPDF

放弃依赖系统默认阅读器，转而调用轻量级开源阅读器 [SumatraPDF](https://www.sumatrapdfreader.org/)。它提供了强大的命令行支持。

  * **实现代码**：
    ```python
    subprocess.run([SUMATRA_PATH, "-print-to-default", "-exit-on-print", file_path])
    ```
  * **参数解析**：
      * `-print-to-default`：直接将文件发送到 Windows 默认打印机。
      * `-exit-on-print`：指令发送完毕后自动关闭软件进程，保持系统整洁。

### 2\. 图片打印原理：调用 Windows 画图 (mspaint)

为了避开“照片”应用的弹窗，我们利用 Windows 内置的老牌“画图”工具 (`mspaint.exe`)。

  * **实现代码**：
    ```python
    subprocess.run(["mspaint", "/p", file_path])
    ```
  * **参数解析**：
      * `/p`：这是 mspaint 的隐藏参数（Print），告诉它打开文件后直接打印，不要显示界面。

### 3\. 多线程防卡顿 (Threading)

为了保证打印过程中 GUI 界面依然流畅（可拖动、显示日志），我们将打印任务放入后台线程执行。

  * **机制**：
      * 主线程 (`tkinter mainloop`)：负责响应点击、刷新界面、更新进度条。
      * 子线程 (`threading.Thread`)：负责循环遍历文件列表，执行耗时的 `subprocess.run` 打印命令。

## 📋 环境依赖

1.  **Python 3.x**
2.  **SumatraPDF** (需安装或下载便携版)
      * 需在代码 `SUMATRA_PATH` 变量中配置其 `.exe` 路径。

## 🚀 使用方法

1.  运行脚本启动 GUI 界面。
2.  点击 **"选择文件并打印"** 按钮（支持多选、框选）。
3.  确认弹窗提示的文件数量。
4.  程序自动在后台排队打印，并在界面下方输出实时日志。

-----

